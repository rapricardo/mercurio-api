# üöÄ Mercurio API - Production Environment Template
# Copy this file to .env.production and update with your values

# =============================================================================
# üîß APPLICATION SETTINGS
# =============================================================================

NODE_ENV=production
PORT=3000

# Application Identification
APP_NAME=mercurio-api
APP_VERSION=1.0.0

# =============================================================================
# üóÑÔ∏è  DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Connection (REQUIRED)
DATABASE_URL="postgresql://username:password@hostname:port/database_name"

# Connection Pool Settings
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20
DATABASE_TIMEOUT=30000

# =============================================================================
# üîê ENCRYPTION & SECURITY
# =============================================================================

# Master Encryption Key (REQUIRED) - Generate with: openssl rand -base64 32
ENCRYPTION_KEK_SECRET="your-base64-encoded-32-byte-key"

# Data Encryption Keys (REQUIRED) - Generate with: openssl rand -base64 32
EMAIL_DEK_SECRET="your-base64-encoded-email-encryption-key"
PHONE_DEK_SECRET="your-base64-encoded-phone-encryption-key"

# Fingerprint Secrets (REQUIRED) - Generate with: openssl rand -hex 32
EMAIL_FINGERPRINT_SECRET="your-hex-encoded-email-fingerprint-secret"
PHONE_FINGERPRINT_SECRET="your-hex-encoded-phone-fingerprint-secret"

# Key Versioning
ENCRYPTION_KEY_VERSION=1

# =============================================================================
# üìä LOGGING & MONITORING
# =============================================================================

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json

# Enable structured logging with correlation IDs
REQUEST_LOGGING=true
SQL_LOGGING=false

# =============================================================================
# üöÄ PERFORMANCE & CACHING
# =============================================================================

# Redis Configuration (Optional but recommended)
REDIS_ENABLED=false
REDIS_URL="redis://redis-host:6379"

# Cache TTL Settings (milliseconds)
ANALYTICS_CACHE_TTL_24H=300000     # 5 minutes
ANALYTICS_CACHE_TTL_7D=900000      # 15 minutes
ANALYTICS_CACHE_TTL_30D=3600000    # 1 hour

# API Key Cache
API_KEY_CACHE_TTL=300000           # 5 minutes

# =============================================================================
# üîí AUTHENTICATION & AUTHORIZATION
# =============================================================================

# Supabase Configuration (Optional)
SUPABASE_ENABLED=false
SUPABASE_URL="https://your-project.supabase.co"
SUPABASE_SERVICE_ROLE_KEY="your-supabase-service-role-key"
SUPABASE_ANON_KEY="your-supabase-anon-key"

# JWT Configuration
JWT_SECRET="your-jwt-secret-key"
JWT_EXPIRES_IN="24h"

# =============================================================================
# üõ°Ô∏è RATE LIMITING & SECURITY
# =============================================================================

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000         # 1 minute
RATE_LIMIT_MAX_REQUESTS=1000       # requests per window

# CORS Settings
CORS_ENABLED=true
CORS_ORIGIN="https://yourdomain.com,https://admin.yourdomain.com"
CORS_CREDENTIALS=true

# Security Headers
SECURITY_HEADERS_ENABLED=true

# =============================================================================
# üìà ANALYTICS & METRICS
# =============================================================================

# Metrics Collection
METRICS_ENABLED=true
METRICS_COLLECTION_INTERVAL=60000

# Performance Thresholds
PERF_P50_THRESHOLD_MS=50
PERF_P95_THRESHOLD_MS=500
PERF_MEMORY_WARNING_PCT=80

# Analytics Export Limits
ANALYTICS_MAX_EXPORT_SIZE=100000
ANALYTICS_EXPORT_TIMEOUT_MS=300000

# =============================================================================
# üîß FEATURE FLAGS
# =============================================================================

# Core Features
FEATURE_ANALYTICS_ENABLED=true
FEATURE_FUNNELS_ENABLED=true
FEATURE_EXPORTS_ENABLED=true
FEATURE_REALTIME_ENABLED=true

# Advanced Features
FEATURE_ADVANCED_ANALYTICS_ENABLED=false
FEATURE_ML_INSIGHTS_ENABLED=false
FEATURE_CUSTOM_DIMENSIONS_ENABLED=false

# =============================================================================
# üè¢ TENANT & WORKSPACE SETTINGS
# =============================================================================

# Default Settings
TENANT_DEFAULT_PLAN=starter
TENANT_MAX_PER_USER=5
WORKSPACE_MAX_PER_TENANT=10

# Data Retention
DEFAULT_DATA_RETENTION_DAYS=90
WORKSPACE_PROD_MIN_RETENTION=365
WORKSPACE_DEV_MAX_RETENTION=30

# =============================================================================
# üí≥ BILLING & INTEGRATIONS
# =============================================================================

# Billing Provider
BILLING_PROVIDER=manual
STRIPE_SECRET_KEY="sk_live_..."
STRIPE_WEBHOOK_SECRET="whsec_..."
STRIPE_PUBLISHABLE_KEY="pk_live_..."

# Webhook Configuration
WEBHOOK_ENABLED=false
WEBHOOK_URL="https://your-api.com/webhooks/mercurio"
WEBHOOK_SECRET="your-webhook-secret"

# =============================================================================
# üìß NOTIFICATIONS & ALERTS
# =============================================================================

# Email Configuration (Optional)
SMTP_HOST="smtp.yourmailprovider.com"
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER="noreply@yourdomain.com"
SMTP_PASS="your-smtp-password"

# Slack Notifications (Optional)
SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
SLACK_ALERTS_ENABLED=false

# =============================================================================
# üê≥ DEPLOYMENT & INFRASTRUCTURE
# =============================================================================

# Health Check Settings
HEALTH_CHECK_ENABLED=true
HEALTH_DB_TIMEOUT_MS=5000
HEALTH_MEMORY_WARNING_MB=512
HEALTH_MEMORY_CRITICAL_MB=1024

# Graceful Shutdown
SHUTDOWN_TIMEOUT_MS=10000

# Prometheus Metrics
PROMETHEUS_METRICS_ENABLED=true
PROMETHEUS_METRICS_PREFIX=mercurio

# =============================================================================
# üîç DEBUGGING & DEVELOPMENT
# =============================================================================

# Debug Settings (set to false in production)
DEBUG_ENABLED=false
DEBUG_SQL_QUERIES=false
DEBUG_CACHE_OPERATIONS=false

# Development Tools (disable in production)
SWAGGER_ENABLED=false
API_DOCUMENTATION_ENABLED=false

# =============================================================================
# üìù NOTES & INSTRUCTIONS
# =============================================================================

# 1. SECURITY: Never commit this file with real values to version control
# 2. ENCRYPTION: Generate new encryption keys for each environment
# 3. DATABASE: Ensure PostgreSQL 13+ is configured with proper connection pooling
# 4. REDIS: Recommended for production for improved performance
# 5. MONITORING: Configure monitoring tools to track the metrics endpoints
# 6. BACKUPS: Ensure regular database backups are configured
# 7. SSL/TLS: Use HTTPS in production (configure at load balancer/reverse proxy level)

# =============================================================================
# üö® SECURITY CHECKLIST
# =============================================================================

# ‚úÖ Generated unique encryption keys
# ‚úÖ Configured strong DATABASE_URL with restricted user
# ‚úÖ Set appropriate CORS origins
# ‚úÖ Disabled debug flags
# ‚úÖ Configured rate limiting
# ‚úÖ Set up monitoring and alerting
# ‚úÖ Configured log aggregation
# ‚úÖ Set up SSL/TLS termination
# ‚úÖ Configured firewalls and security groups
# ‚úÖ Set up backup and recovery procedures